function ArticleController(a,b,c,d,e){var f=c.num;void 0==f&&(f=1),d.getArticles(f).then(function(b){a.articles=b.data.data,a.totalPages=b.data.totalPages,a.hasPrev=b.data.hasPrePage,a.hasNext=b.data.hasNextPage,a.currentPage=parseInt(f)}),a.openDelDialog=function(c){var f=b.open({templateUrl:"/static/admin/view/article/article_del_dialog.html",controller:"DelDialogController"});f.result.then(function(){d.delArticle(a.articles[c]).then(function(){a.articles.splice(c,1)},function(){e.showAlert()})})}}function BlogOwnerUpdate(a,b){a.blogowner={};var c=function(){var c={};void 0!=a.blogowner.icon&&(c.icon=a.blogowner.icon),void 0!=a.blogowner.intro&&(c.introduction=a.blogowner.intro),b.upload({url:"/api/admin/blogowner/update",data:c}).success(function(){a.blogowner.result="更新成功"}).error(function(b){console.log(b),a.blogowner.result="更新失败",a.blogowner.isErr=!0})};a.update=c}function CategoryController(a,b,c,d,e){d.getCategories().then(function(b){a.categories=b.data.data});var f=function(c){var f=b.open({templateUrl:"/static/admin/view/category/category_del_dialog.html",controller:"DelDialogController"});f.result.then(function(){d.delCategory(a.categories[c]).then(function(){a.categories.splice(c,1)},function(a){e.showAlert()})})},g=function(e){var f=b.open({templateUrl:"/static/admin/view/category/category_addupdate_dialog.html",controller:"updateCategoryDialogController",resolve:{categoryName:function(){return void 0!=e?a.categories[e].name:void 0}}});void 0!=e?f.result.then(function(b){var f=a.categories[e];f.name=b,d.updateCategory(f).then(function(){c.location.href="/admin/category"})}):f.result.then(function(a){var b={name:a};d.addCategory(b).then(function(){c.location.href="/admin/category"})})};a.openDelDialog=f,a.openUpdateDialog=g}function updateCategoryDialogController(a,b,c){a.categoryName=c,a.ok=function(){b.close(a.categoryName)},a.cancel=function(){b.dismiss()}}function UpdateArticleController(a,b,c,d,e){a.$on("$viewContentLoaded",configMarkdown),e.getCategories().then(function(b){a.categories=b.data.data});var f=!1;a.article={},"update"===c.op&&(d.getArticleInfo(c.id).then(function(b){var c=b.data.data;a.article.title=c.title,a.article.category_id=c.category.id,a.article.content=c.content}),a.article.id=c.id,f=!0),a.SaveOrUpdateArticle=function(){d.addOrUpdateArticle(a.article,f).then(function(){b.location.href="/admin/article"})}}function configMarkdown(){$("textarea[data-provide='markdown']").markdown({language:"zh",fullscreen:{enable:!0},resize:"vertical"})}var blogMain=angular.module("myblog-main",["ngRoute","ngAnimate","ngFileUpload","ui.bootstrap","myblog.services","myblog.alert"]);blogMain.config(["$routeProvider","$locationProvider",function(a,b){a.when("/admin/article",{templateUrl:"/static/admin/view/article/article_main.html",controller:"ArticleController"}).when("/admin/article/:op",{templateUrl:"/static/admin/view/article/article_info.html",controller:"UpdateArticleController"}).when("/admin/category",{templateUrl:"/static/admin/view/category/category_main.html",controller:"CategoryController"}).when("/admin/blogowner",{templateUrl:"/static/admin/view/blogowner/blogonwer_info.html",controller:"BlogUploadController"}).when("/admin/article/page/:num",{templateUrl:"/static/admin/view/article/article_main.html",controller:"ArticleController"}).otherwise({redirectTo:"/admin/article"}),b.html5Mode(!0)}]),blogMain.controller("DelDialogController",function(a,b){a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}}),blogMain.filter("range",function(){return function(a,b){b=parseInt(b);for(var c=0;b>c;c++)a.push(c);return a}}),blogMain.controller("ArticleController",ArticleController),ArticleController.$inject=["$scope","$uibModal","$routeParams","ArticleRestService","AlertService"],BlogOwnerUpdate.$inject=["$scope","Upload"],blogMain.controller("BlogUploadController",BlogOwnerUpdate),blogMain.controller("CategoryController",CategoryController).controller("updateCategoryDialogController",updateCategoryDialogController),CategoryController.$inject=["$scope","$uibModal","$window","CategoryRestService","AlertService"],updateCategoryDialogController.$inject=["$scope","$uibModalInstance","categoryName"],blogMain.controller("UpdateArticleController",UpdateArticleController),UpdateArticleController.$inject=["$scope","$window","$routeParams","ArticleRestService","CategoryRestService"],angular.module("myblog.alert",["ngAnimate"]).factory("AlertService",["$rootScope","$timeout",function(a,b){return a.closeAlert=function(){a.isShow=!1},{showAlert:function(){a.isShow=!0,b(function(){a.closeAlert()},2e3)}}}]),angular.module("myblog.services",[]).factory("CategoryRestService",["$http","$q","$httpParamSerializerJQLike",function(a,b,c){var d=function(d){var e=b.defer();return a({method:"POST",url:"/api/admin/category/add",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:c({name:d.name})}).then(function(a){e.resolve(a)},function(a){e.reject(a)}),e.promise},e=function(c){var d=b.defer();return a({method:"GET",url:"/api/admin/category/del/"+c.id}).then(function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},f=function(d){var e=b.defer();return a({method:"POST",url:"/api/admin/category/update/"+d.id,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:c({name:d.name})}).success(function(a){e.resolve(a)}).error(function(a){e.reject(a)}),e.promise},g=function(){var c=b.defer();return a({method:"GET",url:"/api/admin/categories"}).then(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise};return{addCategory:d,delCategory:e,updateCategory:f,getCategories:g}}]).factory("ArticleRestService",["$http","$q","$httpParamSerializer",function(a,b,c){var d=function(d,e){var f=b.defer(),g="/api/admin/article/add";return e&&(g="/api/admin/article/update/"+d.id),a({method:"POST",url:g,headers:{"Content-type":"application/x-www-form-urlencoded"},data:c({title:d.title,content:d.content,category_id:d.category_id})}).then(function(a){f.resolve(a)},function(a){f.reject(a)}),f.promise},e=function(c){var d=b.defer();return a({method:"Get",url:"/api/admin/article/del/"+c.id}).then(function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},f=function(c){var d=b.defer();return a({method:"GET",url:"/api/admin/articles/"+c}).then(function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise},g=function(c){var d=b.defer();return a({method:"GET",url:"/api/admin/article/"+c}).then(function(a){d.resolve(a)},function(a){d.reject(a)}),d.promise};return{addOrUpdateArticle:d,delArticle:e,getArticles:f,getArticleInfo:g}}]);